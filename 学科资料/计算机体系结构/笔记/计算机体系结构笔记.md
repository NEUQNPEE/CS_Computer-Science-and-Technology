# 计算机体系结构笔记
[TOC]

# 1 基础知识

## 1.4 计算机系统结构的发展

### 1.4.1 冯·诺依曼结构及其改进

### 1.4.2 软件对系统结构的影响

* 软件的可移植性

一个软件可以不经修改或者只需少量修改就可以由一台机器移植到另一台机器上正确地运行。差别只是执行时间的不同。我们称这两台机器是软件兼容的。

* 实现可移植性的常用方法
  
采用系列机，模拟与仿真，统一高级语言 。

1. 统一高级语言 

* 实现软件移植的一种理想的方法
* 较难实现

1. 系列机 

* 由同一厂家生产的具有相同的系统结构，但具有不同组成和实现的一系列不同型号的机器。
* 较好地解决软件开发要求系统结构相对稳定与器件、硬件技术迅速发展的矛盾。
* 软件兼容：向后兼容是系列机的根本特征。

3. 模拟和仿真

* 使软件能在具有不同系统结构的机器之间相互移植。
    * 在一种系统结构上实现另一种系统结构。
    * 从指令集的角度来看，就是要在一种机器上实现另一种机器的指令集。

* 模拟：用软件的方法在一台现有的机器（称为宿主机）上实现另一台机器（称为虚拟机）的指令集。
    * 通常用解释的方法来实现。
    * 运行速度较慢，性能较差。

* 仿真：用一台现有机器（宿主机）上的微程序去解释实现另一台机器（目标机）的指令集。
    * 运行速度比模拟方法的快
    * 仿真只能在系统结构差距不大的机器之间使用

## 1.5 并行性

### 1.5.1 并行性的概念

从执行程序的角度来看。并行性等级从低到高可分为以下5种：

1) 指令内部井行

指令内部并行是指单条指令中各微操作之间的并行。

2) 指令级并行
   
指令级并行(Instruction Level Parallelism.ILP)是指井行或井发地执行两条或两条以
上的指令。

流水线技术使得多条指令能重叠地执行,提高了CPU执行程序的春吐率。加上RISC方法,计算机达到了每个时钟周期完成一条指令的性能。超标量(Superscalar)的方法则更进一步,使得计算机能每个时钟周期启动多条指令,并能由多条流水线在单周期内产生多个运算站果。超标量主要是用来开发指令级井行的。

3) 线程级并行

线程级井行(Thread Level Parallelism.TLP)是指并行执行两个或两个以上的线程。

4) 任务级或过程级井行

任务级或过程级井行是指并行执行两个或两个以上的过程或任务(程序段),以子程序或进程为调度单元。

5) 作业或程序级井行

作业或程序级并行是指并行执行两个或两个以上的作业或程序。

### 1.5.2 提高并行性的技术途径

计算机系统中提高井行性的措施有很多，就其基本思想而言，可归纳成以下三条途径。

1) 时间重叠(Time Interleaving)。

在井行性概念中引入时间因素，让多个处理过程在时间上相互错开，轮流重叠地使用同一套硬件设备的各个部分，以加快硬件周转而赢得速度。这种途径原则上不要求重复设置硬件设备。流水线技术是时间重叠的典型实例。

2) 资源重复(Resource Replication)。

在井行性概念中引入空间因素，以数量取胜。通过重复设置硬件资源，大幅度地提高计算机系统的性能。随着硬件价格的降低，这种途径得到了越来越广泛的应用。可以在单处理机中重复设置多个运算部件或处理部件，也可以重复设置多台处理机，构成多处理机系統。在现在的计算机系统統中，经常是同时运用时间重叠和资源重复。

3) 资源共享(Resource Sharing)。

这是一种软件方法，它便多个任务按一定的时间顺序轮流使用同一套硬件设备。多道程序、分时系统就是遵循这一途径而产生的。盗源共享既降低了成本，又提高了计算机设备的利用率。

### 1.5.3 单机系统中井行性的发展

在发展高性能单处理机的过程中，起主导作用的是时间重叠原理。实现时间重叠的基础是“部件功能专用化”,即把一件工作按功能分割为若干相互联系的部分，把每一部分指定给专门的部件完成，然后按时间重叠原理把每部分的执行过程在时间上重叠起来，使所有部件依次分工完成一组同样的工作。例如，把一条指令的解释过程分为4个子过程:取指令、指令译码、指令执行、写回结果，为每个子过程分配一个专用部件，并将它们的工作按某种时间关系重叠起来，就构成了指令流水线。

在单处理机中，资源重复原理的运用也已经十分普遍。例如，多体存储器和多操作部件都是成功应用的结构形式。在多操作部件处理机中，通用部件被分解成若干个专用部件，如加法部件、乘法部件、除法部件、逻辑运算部件等，而且同一种部件也可以重复设置多个。只要指令所需的操作部件空闲，就可以开始执行这条指令（如果操作数已准备就绪），这就实现了指令级并行。如果更进一步，设置许多相同的处理单元，让它们在同一个控制器的指挥下，按照同一条指令的要求，对向量或数组的个元素同时进行同一操作，就形成了阵列处理机（有的书称为并行处理机）

# 2 指令系统的设计